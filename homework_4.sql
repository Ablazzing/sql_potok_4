-- Закрытая вечеринка.

-- 1. Создать таблицу party_guest: name, email, (id само собой), пришел или нет (по умолчанию стоит нет). 
--Name, email не может быть null и быть пустым.  Email уникален.
-- 2. Создать пользователя manager. Он может заносить данные в таблицу с гостями, а так же смотреть список гостей.
-- + (дать права на работу со схемой public)
-- 3. Создать view party_guest_name. Должны быть только имена гостей.
-- 4. Создать пользователя guard. Он может только смотреть только view party_guest_name.
-- 5. Переключиться на пользователя manager. Создать под этой ролью записи в таблице party_guest (имя, email):
-- --Charles charles_ny@yahoo.com
-- --Charles mix_tape_charles@google.com
-- --Teona miss_teona_99@yahoo.com
-- 6. Переключиться на роль guard и посмотреть имена. Проверить, что guard не имеет доступа к таблице party_guest.
-- 7. Перейти в роль postgres
-- 8. Создать процедуру party_end, которая будет закидывать в черный список всех тех людей, которые записались на вечеринку, но не пришли:
-- 8.1. Создает таблицу black_list (id, email) если она не существует.
-- 8.2. Записывает в black_list тех, кто не пришел на вечеринку.
-- 8.3. Очищает таблицу party_guest.
-- 9. Создать функцию записи на вечеринку register_to_party: на вход будет принимать name, email. Функция будет:
-- 9.1 Проверяет есть ли таблица black_list (см комментарий), если есть, то:
-- 9.1.1. Проверять есть ли такой человек в black_list по email. Если такой человек есть, то функция вернет false
-- 9.2. Если человека нет в черном списке или таблицы black_list не существует , то вставить запись в таблицу party_guest name и email и вернуть true.
-- 10. Зарегистрировать Petr, korol_party@yandex.ru на вечеринку с помощью функции.
-- 11. На вечеринку пришли гости с email - mix_tape_charles@google.com, miss_teona_99@yahoo.com. Поменять статус у них на "пришел"
-- 12. Запустить процедуру party_end.

-- Комментарий:
-- Для получения информации, есть ли такая таблица в схеме, можно воспользоваться SELECT to_regclass('[имя схемы].[имя таблицы]') is not null;
